---
apiVersion: v1
kind: ConfigMap
metadata:
  name: crashsense-config
  namespace: crashsense
data:
  config.toml: |
    provider = "openai"
    
    [local]
    ollama_path = null
    model = "llama3.2:1b"
    
    [memory]
    path = "/root/.crashsense/memories.db"
    max_entries = 1000
    retention_days = 365
    
    [security]
    use_keyring = false
    
    [last]
    last_log = "/root/.crashsense/last.log"
    
    [rag]
    enabled = true
    docs = [
      "/app/src/data/crashsense_best_practices.md",
      "/app/src/data/python_exceptions_playbook.md",
      "/app/src/data/web_server_error_patterns.md",
      "/app/src/data/linux_permission_paths.md",
      "/app/src/data/kubernetes_remediation_playbook.md",
    ]
    chunk_chars = 800
    chunk_overlap = 120
    top_k = 3
    
    [kubernetes]
    enabled = true
    kubeconfig = null
    namespaces = []  # Monitor all namespaces
    auto_heal = true
    dry_run = false
    max_remediation_actions = 10
    monitor_interval_seconds = 60
    crash_time_window_minutes = 15
    resource_threshold_percent = 85
    
    [prometheus]
    enabled = true
    url = "http://prometheus.monitoring.svc:9090"
    alertmanager_url = "http://alertmanager.monitoring.svc:9093"
    metrics_port = 8000
    scrape_interval_seconds = 15
